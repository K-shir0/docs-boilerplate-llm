# Markdown トラブルシューティングガイド

このドキュメントは、Markdown ドキュメント作成時によく発生する問題、その原因、解決策、およびアンチパターンを包括的に説明します。

## 目次

1. [構造に関する問題](#構造に関する問題)
2. [リストに関する問題](#リストに関する問題)
3. [コードブロックに関する問題](#コードブロックに関する問題)
4. [テキスト記述に関する問題](#テキスト記述に関する問題)
5. [リンクに関する問題](#リンクに関する問題)
6. [レンダリングに関する問題](#レンダリングに関する問題)
7. [アンチパターン詳細](#アンチパターン詳細)

## 構造に関する問題

### 問題: 見出し構造が深くなりすぎる

**症状:**

```markdown
# タイトル
## セクション
### サブセクション
#### さらに深い
##### もっと深い
###### 最も深い
```

**原因:**

* セクションを細かく分けすぎている
* H4 以降の見出しレベルを使用している
* 階層構造の設計が不適切

**解決策:**

1. H3 までの見出しに制限

	```markdown
	# タイトル
	## セクション
	### サブセクション
	```

2. それ以降はネストしたリストで表現

	```markdown
	### サブセクション

	* さらに深い内容
		* もっと深い内容
			* 最も深い内容
	```

3. セクションの分割を再検討

	情報を MECE 原則で整理し、必要に応じてセクションを統合または分割します。

**ベストプラクティス:**

* 見出しは H1-H3 までに制限
* 4階層以上の情報はリストのネストで表現
* 深い階層が必要な場合はドキュメント分割を検討

### 問題: H1 が複数ある

**症状:**

```markdown
# 最初のタイトル

内容...

# 別のタイトル

別の内容...
```

**原因:**

* ドキュメントの構造を理解していない
* セクション分けに H1 を使用している

**解決策:**

H1 はドキュメント全体のタイトルとして1つのみ使用し、セクションには H2 を使用:

```markdown
# ドキュメントタイトル

## 最初のセクション

内容...

## 別のセクション

別の内容...
```

### 問題: 見出しに連番がある

**症状:**

```markdown
# システム設計書

## 1. 概要
## 2. アーキテクチャ
### 2.1 フロントエンド
### 2.2 バックエンド
## 3. データベース設計
```

**原因:**

* 従来の文書作成の習慣
* 章番号が必要だと誤解

**解決策:**

Markdown では見出しから連番を削除し、構造で表現:

```markdown
# システム設計書

## 概要
## アーキテクチャ
### フロントエンド
### バックエンド
## データベース設計
```

**理由:**

* Markdown のレンダリングエンジンやツールが自動的に番号付けに対応可能
* 手動の連番は保守が困難
* 構造自体が順序を表現

## リストに関する問題

### 問題: リストのインデントが揃わない

**症状:**

```markdown
* 項目1
  * サブ項目（スペース2つ）
    * サブサブ項目（スペース4つ）
	* 別のサブサブ項目（タブ）
```

**原因:**

* スペースとタブが混在している
* エディタの設定が不統一
* コピー&ペーストによる混入

**解決策:**

1. タブのみを使用してインデント

	```markdown
	* 項目1
		* サブ項目
			* サブサブ項目
	```

2. エディタの設定でタブを可視化

	VS Code の場合:

	```json
	{
		"editor.renderWhitespace": "all"
	}
	```

3. 既存ファイルのスタイルに従う

	プロジェクト内の他のファイルを確認し、統一されたスタイルを使用します。

### 問題: ハイフンでリストを記述している

**症状:**

```markdown
- 項目1
- 項目2
  - サブ項目
```

**原因:**

* デフォルトの習慣
* 他の Markdown ドキュメントからのコピー
* 記述規則を知らない

**解決策:**

アスタリスク（*）に統一:

```markdown
* 項目1
* 項目2
	* サブ項目
```

**エディタでの一括置換:**

VS Code で正規表現を使用:

* 検索: `^(\s*)-\s`
* 置換: `$1* `

### 問題: リスト内の複数段落が正しく表示されない

**症状:**

```markdown
* 第1項目

この段落がリスト外として表示される。

* 第2項目
```

**原因:**

* 段落のインデントが不足
* リスト項目と段落の間の空行処理が不適切

**解決策:**

リスト内の段落はタブでインデント:

```markdown
* 第1項目

	この段落はリスト内として表示される。

	2つ目の段落も同様にインデント。

* 第2項目
```

## コードブロックに関する問題

### 問題: コードブロックに言語指定がない

**症状:**

````markdown
```
npm install
```
````

**原因:**

* 言語指定の必要性を知らない
* 手間を省いている

**解決策:**

適切な言語を指定:

````markdown
```bash
npm install
```
````

**主な言語識別子:**

* `bash`, `sh` - シェルコマンド
* `javascript`, `js` - JavaScript
* `typescript`, `ts` - TypeScript
* `python`, `py` - Python
* `json` - JSON
* `yaml`, `yml` - YAML
* `markdown`, `md` - Markdown

### 問題: コードブロック内のバッククォートが表示されない

**症状:**

コードブロック内で ``` を使用したい場合、正しく表示されない。

**原因:**

* バッククォートがコードブロックの終了と解釈される

**解決策:**

より多くのバッククォートでコードブロックを囲む:

`````markdown
````markdown
```javascript
console.log('example');
```
````
`````

### 問題: インラインコードが途中で切れる

**症状:**

```markdown
`この文中にバッククォート`が含まれる`場合
```

**原因:**

* インラインコード内にバッククォートが含まれている

**解決策:**

ダブルバッククォートを使用:

```markdown
`` この文中にバッククォート ` が含まれる場合 ``
```

## テキスト記述に関する問題

### 問題: 英語と日本語の間にスペースがない

**症状:**

```markdown
GitHubリポジトリ
APIエンドポイント
Reactコンポーネント
```

**原因:**

* スペーシング規則を知らない
* 入力時に忘れる

**解決策:**

英語と日本語の間に半角スペースを挿入:

```markdown
GitHub リポジトリ
API エンドポイント
React コンポーネント
```

**自動化:**

エディタの拡張機能や linter で自動チェック・修正:

```bash
# 検索パターン（正規表現）
([a-zA-Z])([ぁ-んァ-ヶ一-龠])

# 置換パターン
$1 $2
```

### 問題: 強調表示を過度に使用している

**症状:**

```markdown
**重要**: この設定は**必須**です。*必ず*実行してください。
```

**原因:**

* 重要性を強調したい
* 視覚的に目立たせたい

**解決策:**

構造と階層で重要性を表現:

```markdown
## 重要事項

この設定は必須です。必ず実行してください。
```

または、リストで整理:

```markdown
## セットアップ手順

以下の設定は必須です:

* データベース接続設定
* 環境変数の設定
* 依存関係のインストール
```

## リンクに関する問題

### 問題: 内部リンクが機能しない

**症状:**

```markdown
[詳細はこちら](#詳細セクション)
```

をクリックしても該当セクションに移動しない。

**原因:**

* アンカー名が見出しと一致していない
* 日本語の見出しの場合、エンコーディングの問題

**解決策:**

1. 正確なアンカー名を使用

	```markdown
	[詳細はこちら](#詳細セクション)

	## 詳細セクション
	```

2. 英語の見出しを使用（推奨されるケース）

	```markdown
	[詳細はこちら](#details)

	## Details {#details}
	```

3. GitHub などのプラットフォーム特有のルールを確認

	GitHub では日本語見出しも自動的にアンカーに変換されます。

### 問題: 相対パスリンクが壊れる

**症状:**

```markdown
[設計書](docs/design.md)
```

がドキュメントの配置によって機能しない。

**原因:**

* 相対パスの基点が不明確
* ファイル移動による影響

**解決策:**

1. リポジトリルートからの相対パスを使用

	```markdown
	[設計書](/docs/design.md)
	```

2. 同じディレクトリ内のファイル

	```markdown
	[設計書](./design.md)
	```

3. 親ディレクトリのファイル

	```markdown
	[設計書](../docs/design.md)
	```

## レンダリングに関する問題

### 問題: テーブルが正しく表示されない

**症状:**

```markdown
| 列1 | 列2 |
| A | B |
```

**原因:**

* ヘッダーとボディの区切り行がない

**解決策:**

区切り行を追加:

```markdown
| 列1 | 列2 |
|-----|-----|
| A   | B   |
```

### 問題: 水平線が表示されない

**症状:**

```markdown
---
```

が水平線として表示されない。

**原因:**

* 前後に空行がない
* YAML フロントマターと誤認されている

**解決策:**

前後に空行を追加:

```markdown
内容...

---

別の内容...
```

### 問題: リストが正しくレンダリングされない

**症状:**

```markdown
以下のリストを確認:
* 項目1
* 項目2
```

リストが段落の一部として表示される。

**原因:**

* リストの前に空行がない

**解決策:**

リストの前に空行を追加:

```markdown
以下のリストを確認:

* 項目1
* 項目2
```

## アンチパターン詳細

### アンチパターン 1: 過度な装飾

**悪い例:**

```markdown
# **重要なお知らせ！！！**

***これは非常に重要です***

**必ず**お読みください！！
```

**なぜ悪いのか:**

* 視覚的ノイズが多い
* プロフェッショナルな印象を損なう
* アクセシビリティの問題
* Markdown の哲学に反する

**良い例:**

```markdown
# 重要なお知らせ

これは重要な情報です。必ずお読みください。
```

### アンチパターン 2: 不適切な見出しレベル

**悪い例:**

```markdown
# タイトル

##### 詳細説明

###### さらに詳細
```

**なぜ悪いのか:**

* 階層をスキップしている（H2, H3, H4 を飛ばして H5）
* 構造が不明確
* アクセシビリティツールが正しく解釈できない

**良い例:**

```markdown
# タイトル

## 概要

### 詳細説明

* さらに詳細
	* より詳しい内容
```

### アンチパターン 3: HTML の過度な使用

**悪い例:**

```markdown
<div style="color: red; font-size: 20px;">
  <strong>重要な情報</strong>
</div>

<table>
  <tr>
    <td>複雑なテーブル</td>
  </tr>
</table>
```

**なぜ悪いのか:**

* Markdown の可読性を損なう
* ポータビリティが低下
* 保守が困難
* Markdown の目的に反する

**良い例:**

```markdown
## 重要な情報

| 項目 | 内容 |
|------|------|
| A    | B    |
```

### アンチパターン 4: 曖昧なリンクテキスト

**悪い例:**

```markdown
詳細は[こちら](https://example.com)をクリック。
[ここ](https://example.com)を参照してください。
```

**なぜ悪いのか:**

* スクリーンリーダーでリンクのコンテキストが不明
* SEO に悪影響
* ユーザビリティが低い

**良い例:**

```markdown
詳細は [API ドキュメント](https://example.com/api) を参照してください。
[トラブルシューティングガイド](https://example.com/troubleshooting) で解決方法を確認できます。
```

### アンチパターン 5: 長大な一つのドキュメント

**悪い例:**

5000 行を超える単一の README.md ファイルにすべての情報を詰め込む。

**なぜ悪いのか:**

* ナビゲーションが困難
* 検索性が低い
* 保守が困難
* パフォーマンスの問題

**良い例:**

```markdown
# プロジェクト名

## ドキュメント

* [セットアップガイド](./docs/setup.md)
* [API リファレンス](./docs/api.md)
* [トラブルシューティング](./docs/troubleshooting.md)
* [貢献ガイド](./CONTRIBUTING.md)
```

### アンチパターン 6: コードブロックの説明不足

**悪い例:**

````markdown
```javascript
const result = data.map(x => x * 2).filter(x => x > 10);
```
````

**なぜ悪いのか:**

* コードの目的が不明
* コンテキストがない
* 学習効果が低い

**良い例:**

````markdown
データを2倍にし、10 より大きい値のみをフィルタリング:

```javascript
const result = data.map(x => x * 2).filter(x => x > 10);
```

実行結果:

```javascript
// data = [1, 5, 10, 15]
// result = [12, 20, 30]
```
````

## デバッグのヒント

### ローカルプレビュー

Markdown の表示を確認するツール:

1. **VS Code のプレビュー機能**

	`Cmd+Shift+V` (Mac) または `Ctrl+Shift+V` (Windows)

2. **GitHub のプレビュー**

	コミット前にブラウザで確認

3. **markserv**

	ローカルサーバーでプレビュー:

	```bash
	npm install -g markserv
	markserv README.md
	```

### デバッグ手順

1. **構文チェック**

	```bash
	markdownlint README.md
	```

2. **リンクチェック**

	```bash
	npm install -g markdown-link-check
	markdown-link-check README.md
	```

3. **視覚的確認**

	ローカルプレビューで表示を確認

4. **自動修正**

	```bash
	markdownlint --fix README.md
	prettier --write README.md
	```

## まとめ

トラブルシューティングのポイント:

* **予防**: 記述規則に従い、ツールで自動チェック
* **早期発見**: エディタのリアルタイムチェック機能を活用
* **修正**: このガイドを参照して問題を解決
* **学習**: アンチパターンを理解し、避ける

詳細な記述規則は [REFERENCE.md](./REFERENCE.md) を、実例は [EXAMPLES.md](./EXAMPLES.md) を参照してください。

---

**Version:** 1.0.0
**Last Updated:** 2025-11-15
